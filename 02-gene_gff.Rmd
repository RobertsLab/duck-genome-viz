---
title: "02-gene_gff"
output: html_document
---

```{r}
library("tidyverse")
library(rtracklayer)
library(karyoploteR)
```


```{r}
duck.genome <- toGRanges(data.frame(chr=c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18" ), start=c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ), end=c(89643857,	69596280,	57743597, 65288255, 67248332, 61759565, 43120122, 61151155, 38581958, 53961475, 51449921, 50438331, 44396874, 45393038, 47938513, 31980953, 34923512,	27737463)))
```


```{bash}
head -5 feature-tracks/Panopea-generosa-vv0.74.a4.gene.gff3
```


```{bash}
awk -F"\t" 'NR>3 {print $1"\t",$4"\t", $5}' feature-tracks/Panopea-generosa-vv0.74.a4.gene.gff3 | sed 's/PGA_scaffold1__77_contigs__length_89643857/1/g' | grep -v "scaffold" > feature-tracks/scf_01-gen.bed


tail feature-tracks/scf_01-gen.bed
```



```{r}
scf01_gene =  import("feature-tracks/scf_01-gen.bed")

kp_test <- plotKaryotype(genome=duck.genome, plot.type=2, chromosomes=c("1", "2", "18"))
  
kpPlotDensity(kp_test, data=scf01_gene,window.size = 1000000, data.panel=1)  






```
